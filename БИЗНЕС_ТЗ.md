# БИЗНЕС-ТЕХНИЧЕСКОЕ ЗАДАНИЕ
## Система сбора и верификации данных о товарах от поставщиков

---

## 1. ОБЩЕЕ ОПИСАНИЕ

### 1.1. Назначение системы
Система предназначена для централизованного сбора, верификации, хранения и управления информацией о товарах, поступающей от различных поставщиков. Система обеспечивает контроль качества данных, проверку полноты информации, валидацию медиа-контента (фотографии, 3D-модели) и управление жизненным циклом товаров до их экспорта в основную производственную базу данных.

### 1.2. Целевая аудитория
- **Менеджеры по закупкам** - управление поставщиками и категориями товаров
- **Специалисты по данным** - импорт и верификация данных
- **Менеджеры по качеству** - проверка и утверждение товаров
- **Администраторы системы** - настройка атрибутов, workflow, каналов экспорта

### 1.3. Бизнес-цели
1. **Стандартизация данных** - единый формат информации о товарах от всех поставщиков
2. **Контроль качества** - автоматическая и ручная проверка полноты и корректности данных
3. **Ускорение обработки** - автоматизация процессов импорта и верификации
4. **Прозрачность** - отслеживание статусов товаров и истории изменений
5. **Гибкость** - поддержка различных форматов данных от поставщиков

---

## 2. БИЗНЕС-ТРЕБОВАНИЯ

### 2.1. Иерархическая структура данных

Система должна поддерживать следующую иерархию:

```
Категория товаров (ProductCategory)
    └─> Поставщик (Supplier)
        └─> Подкатегория (Subcategory)
            └─> Товар (Product)
```

**Пример:**
```
Сантехника (категория товаров)
    └─> ООО "Акваме" (поставщик)
        ├─> Санфаянс (подкатегория)
        │   └─> Товары (37 шт)
        ├─> Раковины (подкатегория)
        │   └─> Товары (25 шт)
        └─> Смесители (подкатегория)
            └─> Товары (15 шт)
```

### 2.2. Управление справочниками

#### 2.2.1. Категории товаров
- Создание, редактирование, удаление категорий товаров
- Категория имеет: код, название, описание, статус активности
- Одна категория может содержать несколько поставщиков

#### 2.2.2. Поставщики
- Создание, редактирование, удаление поставщиков
- Поставщик привязан к категории товаров
- Информация о поставщике: код, название, контактное лицо, email, телефон, адрес
- Один поставщик может иметь несколько подкатегорий

#### 2.2.3. Подкатегории
- Создание, редактирование, удаление подкатегорий
- Подкатегория привязана к поставщику
- Подкатегория определяет набор атрибутов (эталонных свойств) для товаров
- Одна подкатегория может содержать множество товаров

#### 2.2.4. Атрибуты (глобальный справочник)
- Создание, редактирование, удаление атрибутов
- Атрибут имеет: код, название, тип (текст, число, дата, булево, URL, изображение, выбор)
- Настройка правил валидации для атрибутов
- Атрибуты могут быть обязательными или опциональными
- Атрибуты могут быть уникальными
- Атрибуты могут иметь варианты выбора (для типа "select")

### 2.3. Управление эталонными свойствами

- Каждая подкатегория имеет свой набор эталонных атрибутов
- Атрибуты могут быть добавлены в подкатегорию из глобального справочника
- Для каждого атрибута в подкатегории определяется:
  - Обязательность заполнения
  - Порядок сортировки
- Эталонные свойства используются для проверки полноты данных при импорте

---

## 3. ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### 3.1. Импорт данных

#### 3.1.1. Поддерживаемые форматы
- Excel (.xlsx, .xls)
- CSV
- JSON

#### 3.1.2. Процесс импорта
1. Выбор поставщика и подкатегории
2. Загрузка файла
3. Автоматический маппинг полей (сопоставление полей файла с атрибутами подкатегории)
4. Возможность ручного маппинга полей (JSON конфигурация)
5. Предпросмотр данных (опционально)
6. Импорт товаров
7. Отображение результатов:
   - Количество импортированных товаров
   - Список ошибок
   - Список предупреждений

#### 3.1.3. Обработка данных при импорте
- Товары создаются со статусом "Черновик" (draft)
- Автоматическая валидация обязательных полей
- Проверка типов данных
- Сохранение только эталонных свойств (лишние поля игнорируются)
- Создание первой версии товара

### 3.2. Верификация данных

#### 3.2.1. Автоматическая верификация
Система должна автоматически проверять:

1. **Полнота данных:**
   - Наличие всех обязательных атрибутов
   - Заполненность значений (не пустые)
   - Расчет оценки полноты (0-100%)

2. **Качество данных:**
   - Соответствие типов данных
   - Валидация по правилам атрибутов
   - Проверка уникальности (если атрибут помечен как уникальный)
   - Расчет оценки качества (0-100%)

3. **Медиа-контент:**
   - Проверка доступности URL фотографий
   - Проверка разрешения фотографий
   - Проверка формата и размера файлов
   - Проверка количества фотографий
   - Проверка 3D-моделей (если применимо)
   - Расчет оценки медиа (0-100%)

4. **Общая оценка:**
   - Расчет общей оценки товара (0-100%)
   - Определение статуса на основе оценки

#### 3.2.2. Результаты верификации
- Сохранение результатов верификации
- Список проблем (issues)
- Список отсутствующих обязательных атрибутов
- Список невалидных значений
- История верификаций

### 3.3. Workflow (жизненный цикл товара)

#### 3.3.1. Статусы товаров
1. **Черновик (draft)** - товар создан, но не обработан
2. **В работе (in_progress)** - товар находится в процессе обработки
3. **На проверке (to_review)** - товар требует ручной проверки
4. **Утвержден (approved)** - товар прошел все проверки и готов к экспорту
5. **Отклонен (rejected)** - товар отклонен по причине несоответствия требованиям
6. **Экспортирован (exported)** - товар отправлен в основную БД

#### 3.3.2. Переходы между статусами
- Автоматические переходы на основе результатов верификации
- Ручные переходы через интерфейс
- Проверка возможности перехода
- Логирование всех переходов

#### 3.3.3. Правила переходов
- **draft → in_progress**: автоматически при импорте
- **in_progress → to_review**: если оценка 50-79%
- **in_progress → approved**: если оценка ≥80%
- **in_progress → rejected**: если оценка <50% или критические ошибки
- **to_review → approved**: ручное утверждение менеджером
- **to_review → rejected**: ручное отклонение менеджером
- **approved → exported**: экспорт в основную БД (когда будет реализовано)

### 3.4. Версионирование

- Каждое изменение товара создает новую версию
- Сохранение полной истории изменений
- Возможность просмотра всех версий товара
- Отслеживание автора изменений
- Комментарии к версиям
- Возможность отката к предыдущей версии (опционально)

### 3.5. Поиск и фильтрация

- Поиск товаров по названию, артикулу (SKU)
- Фильтрация по поставщику
- Фильтрация по подкатегории
- Фильтрация по статусу
- Сортировка товаров

### 3.6. Экспорт данных (будущая функциональность)

- Экспорт товаров в каналы (веб-сайт, API, мобильное приложение)
- Настройка конфигурации экспорта для каждого канала
- Фильтрация товаров для экспорта
- Отслеживание статуса экспорта

---

## 4. ТРЕБОВАНИЯ К КАЧЕСТВУ ДАННЫХ

### 4.1. Эталонные свойства
- Каждая подкатегория имеет строго определенный набор эталонных свойств
- При импорте проверяются только эталонные свойства
- Лишние данные из файла поставщика игнорируются

### 4.2. Обязательные поля
- Обязательные атрибуты должны быть заполнены для всех товаров
- Товары с незаполненными обязательными полями не могут быть утверждены

### 4.3. Валидация значений
- Проверка типов данных (текст, число, дата и т.д.)
- Проверка по правилам валидации атрибутов (мин/макс значения, формат и т.д.)
- Проверка уникальности (если атрибут помечен как уникальный)

### 4.4. Медиа-контент
- Минимальные требования к фотографиям (разрешение, формат, размер)
- Проверка доступности URL
- Рекомендации по количеству фотографий

---

## 5. ИНТЕРФЕЙС ПОЛЬЗОВАТЕЛЯ

### 5.1. Главная страница
- Статистика: количество категорий товаров, поставщиков, подкатегорий, товаров
- Описание системы
- Быстрый доступ к разделам

### 5.2. Категории товаров
- Список всех категорий товаров
- Добавление новой категории
- Редактирование категории
- Переход к поставщикам категории
- Фильтрация и поиск

### 5.3. Поставщики
- Список всех поставщиков
- Фильтрация по категории товаров
- Поиск по названию, коду, email
- Добавление нового поставщика
- Редактирование поставщика
- Переход к подкатегориям поставщика

### 5.4. Подкатегории
- Список всех подкатегорий
- Фильтрация по поставщику
- Поиск по названию, коду
- Добавление новой подкатегории
- Редактирование подкатегории
- Управление атрибутами подкатегории
- Переход к товарам подкатегории

### 5.5. Атрибуты
- Список всех атрибутов (глобальный справочник)
- Фильтрация по типу
- Поиск по названию, коду
- Добавление нового атрибута
- Редактирование атрибута
- Настройка правил валидации
- Настройка вариантов выбора (для типа "select")

### 5.6. Товары
- Список всех товаров
- Фильтрация по поставщику, статусу
- Поиск по названию, артикулу
- Просмотр деталей товара:
  - Все атрибуты и их значения
  - История версий
  - Результаты верификации
  - Доступные действия (переходы workflow)
- Управление workflow (переходы между статусами)

### 5.7. Импорт
- Выбор поставщика и подкатегории
- Загрузка файла
- Настройка маппинга полей (автоматический или ручной)
- Запуск импорта
- Просмотр результатов импорта

---

## 6. ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ

### 6.1. Архитектура
- Backend: Python (Flask)
- База данных: SQLite (для разработки), возможность миграции на PostgreSQL
- ORM: SQLAlchemy
- Frontend: HTML, CSS (Bootstrap 5), JavaScript

### 6.2. Структура данных
- Модели данных на основе принципов Akeneo PIM и Saleor
- Поддержка версионирования
- Поддержка workflow
- JSON для хранения значений атрибутов

### 6.3. API
- RESTful API для всех операций
- JSON формат данных
- Обработка ошибок
- Валидация входных данных

### 6.4. Безопасность
- Базовая аутентификация (для production требуется доработка)
- Валидация всех входных данных
- Защита от SQL-инъекций (через ORM)
- Обработка ошибок без раскрытия внутренней структуры

---

## 7. ПРОЦЕССЫ РАБОТЫ

### 7.1. Процесс добавления нового поставщика
1. Создание категории товаров (если не существует)
2. Добавление поставщика в категорию
3. Создание подкатегорий для поставщика
4. Настройка эталонных атрибутов для каждой подкатегории
5. Готовность к импорту товаров

### 7.2. Процесс импорта товаров
1. Выбор поставщика и подкатегории
2. Загрузка файла с данными
3. Автоматический или ручной маппинг полей
4. Импорт товаров (статус: "Черновик")
5. Автоматическая верификация
6. Переход в статус "В работе" → "На проверке" или "Утвержден"
7. Ручная проверка (если требуется)
8. Утверждение товаров
9. Экспорт в основную БД (когда будет реализовано)

### 7.3. Процесс верификации товара
1. Автоматический запуск верификации при импорте
2. Проверка полноты данных
3. Проверка качества данных
4. Проверка медиа-контента
5. Расчет общей оценки
6. Определение статуса на основе оценки
7. Сохранение результатов верификации

---

## 8. ОГРАНИЧЕНИЯ И ОСОБЕННОСТИ

### 8.1. Текущие ограничения
- Экспорт в основную БД не реализован (будет добавлен позже)
- Каналы экспорта не реализованы (будет добавлено позже)
- Асинхронная обработка больших файлов не реализована
- Расширенная аналитика и отчеты не реализованы

### 8.2. Особенности
- Система работает как промежуточное хранилище данных
- Данные проверяются и стандартизируются перед экспортом
- Поддержка различных форматов данных от поставщиков
- Гибкая система атрибутов позволяет адаптироваться к разным типам товаров

---

## 9. КРИТЕРИИ ПРИЕМКИ

### 9.1. Функциональность
- ✅ Все основные функции реализованы и работают
- ✅ Импорт данных из Excel, CSV, JSON
- ✅ Автоматическая верификация данных
- ✅ Workflow управления статусами
- ✅ Версионирование товаров
- ✅ Веб-интерфейс для всех операций

### 9.2. Качество
- ✅ Валидация всех входных данных
- ✅ Обработка ошибок
- ✅ Логирование операций
- ✅ Отслеживание изменений

### 9.3. Производительность
- ⚠️ Оптимизация для больших объемов данных (требуется доработка)
- ⚠️ Асинхронная обработка (требуется доработка)

---

## 10. ПЛАН РАЗВИТИЯ

### 10.1. Ближайшие задачи
1. Реализация экспорта в основную БД
2. Реализация каналов экспорта
3. Асинхронная обработка больших файлов
4. Расширенная аналитика и отчеты

### 10.2. Долгосрочные задачи
1. Интеграция с внешними системами
2. Мультиязычность
3. Расширенная система прав доступа
4. API для внешних интеграций

---

## 11. ГЛОССАРИЙ

- **Категория товаров (ProductCategory)** - верхний уровень иерархии, группирует товары по типам (например, Сантехника, Электроника)
- **Поставщик (Supplier)** - компания или организация, поставляющая товары
- **Подкатегория (Subcategory)** - группировка товаров внутри поставщика, определяет набор эталонных атрибутов
- **Атрибут (Attribute)** - характеристика товара (название, цена, цвет и т.д.)
- **Эталонные свойства** - обязательный набор атрибутов для подкатегории
- **Верификация** - процесс проверки полноты и качества данных о товаре
- **Workflow** - жизненный цикл товара, управление статусами
- **Версионирование** - сохранение истории изменений товара
- **Маппинг полей** - сопоставление полей из файла поставщика с атрибутами системы

---

**Дата создания:** 2024
**Версия:** 1.0
**Статус:** Реализовано (базовая функциональность)

